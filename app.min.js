/* Minified app.js */const BASE_API_URL="https://fedskillstest.coalitiontechnologies.workers.dev",PATIENTS_ENDPOINT="/",USERNAME="coalition",PASSWORD="skills-test",patientListEl=document.getElementById("patientList"),profileNameEl=document.getElementById("profileName"),dobEl=document.getElementById("dob"),genderEl=document.getElementById("gender"),contactInfoEl=document.getElementById("contactInfo"),emergencyEl=document.getElementById("emergency"),insuranceEl=document.getElementById("insurance"),heartRateEl=document.getElementById("heartRate"),tempEl=document.getElementById("temp"),respRateEl=document.getElementById("respRate"),bpStatsEl=document.getElementById("bpStats"),diagTableBody=document.querySelector("#diagTable tbody"),showAllBtn=document.getElementById("showAllBtn");let bpChart=null;const mockPatient={id:"jessica-taylor-001",name:"Jessica Taylor",dob:"1996-08-23",gender:"Female",contact:"(415) 555-1234",emergency:"(415) 555-5678",insurance:"Sunrise Health Assurance",profile_picture:"",vitals:{heartRate:78,temperature:98.6,respiratoryRate:20},diagnostics:[{problem:"Hypertension",description:"Chronic high blood pressure",status:"Under Observation"},{problem:"Type 2 Diabetes",description:"Insulin resistance and elevated blood sugar",status:"Cured"},{problem:"Asthma",description:"Recurrent episodes of bronchial constriction",status:"Inactive"}],bpHistory:[{date:"2023-10",systolic:120,diastolic:110},{date:"2023-11",systolic:125,diastolic:90},{date:"2023-12",systolic:160,diastolic:110},{date:"2024-01",systolic:140,diastolic:100},{date:"2024-02",systolic:150,diastolic:92},{date:"2024-03",systolic:156,diastolic:85}]};function formatDate(e){try{const t=new Date(e);if(!isNaN(t))return t.toLocaleDateString();if(/^\d{4}-\d{2}$/.test(e)){const[t,a]=e.split("-");return`${a}/${t}`}return e}catch(t){return e}}function renderPatientList(e=[mockPatient]){patientListEl.innerHTML="",e.forEach(t=>{const a=t.profile_picture||"https://fedskillstest.ct.digital/4.png",n=document.createElement("li");n.className="patient-item"+(t.name==="Jessica Taylor"?" active":""),n.innerHTML=`<img class="avatar" src="${a}" alt="${t.name}" /><div><div style="font-weight:600">${t.name}</div><div class="meta">${t.gender||""}${t.dob?", "+(new Date().getFullYear()-new Date(t.dob).getFullYear())+" yrs":""}</div></div>`,patientListEl.appendChild(n)})}function populateUI(e){e||(e=mockPatient),profileNameEl.textContent=e.name||"Jessica Taylor",dobEl.textContent=e.dob?formatDate(e.dob):"-",genderEl.textContent=e.gender||"-",contactInfoEl.textContent=e.contact||"-",emergencyEl.textContent=e.emergency||"-",insuranceEl.textContent=e.insurance||"-",heartRateEl.textContent=(e.vitals?.heartRate??"-")+(e.vitals?.heartRate?" bpm":""),tempEl.textContent=(e.vitals?.temperature??"-")+(e.vitals?.temperature?"°F":""),respRateEl.textContent=(e.vitals?.respiratoryRate??"-")+(e.vitals?.respiratoryRate?" bpm":""),diagTableBody.innerHTML="",(e.diagnostics||[]).forEach(t=>{const a=document.createElement("tr");a.innerHTML=`<td>${t.problem}</td><td>${t.description}</td><td>${t.status}</td>`,diagTableBody.appendChild(a)});const t=e.bpHistory&&e.bpHistory[e.bpHistory.length-1]||null;t&&(bpStatsEl.innerHTML=`<div><strong>Systolic</strong> ${t.systolic} — <small>Higher than Average</small></div><div style="margin-top:6px"><strong>Diastolic</strong> ${t.diastolic} — <small>Lower than Average</small></div>`),renderBPChart(e.bpHistory||[])}function renderBPChart(e){const t=document.getElementById("bpChart").getContext("2d"),a=e.map(e=>e.date),n=e.map(e=>e.systolic),r=e.map(e=>e.diastolic);bpChart&&bpChart.destroy(),bpChart=new Chart(t,{type:"line",data:{labels:a,datasets:[{label:"Systolic",data:n,borderWidth:2,tension:.35,fill:!1,pointRadius:4,borderColor:"#ff6b9e",pointBackgroundColor:"#ff6b9e"},{label:"Diastolic",data:r,borderWidth:2,tension:.35,fill:!1,pointRadius:4,borderColor:"#6b7cff",pointBackgroundColor:"#6b7cff"}]},options:{plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!1,suggestedMin:60,suggestedMax:180},x:{grid:{display:!1}}},maintainAspectRatio:!1,responsive:!0}})}async function fetchAllPatients(){const e=new Headers({"Content-Type":"application/json",Authorization:"Basic "+btoa(`${USERNAME}:${PASSWORD}`)});try{const t=`${BASE_API_URL}${PATIENTS_ENDPOINT}`,a=await fetch(t,{method:"GET",headers:e});if(!a.ok)throw new Error("API responded with "+a.status);const n=await a.json();if(Array.isArray(n))return n.map(e=>({id:e.patient_id||e.id||(e.name||"").toLowerCase().replace(/\s+/g,"-"),name:e.name,dob:e.date_of_birth||e.dob||e.dateOfBirth,gender:e.gender,contact:e.phone_number,emergency:e.emergency_contact,insurance:e.insurance_type||e.insurance_provider,profile_picture:e.profile_picture||e.profile_picture_url||"",vitals:{heartRate:e.diagnosis_history?.[0]?.heart_rate?.value??null,temperature:e.diagnosis_history?.[0]?.temperature?.value??null,respiratoryRate:e.diagnosis_history?.[0]?.respiratory_rate?.value??null},diagnostics:(e.diagnostic_list||e.diagnostics||[]).map(e=>({problem:e.name||e.problem,description:e.description,status:e.status})),bpHistory:(e.diagnosis_history||[]).map(e=>({date:`${e.month||""}-${e.year||""}`,systolic:e.blood_pressure?.systolic?.value??null,diastolic:e.blood_pressure?.diastolic?.value??null})).reverse()}));if(n&&n.patients&&Array.isArray(n.patients))return fetchAllPatients(n.patients);if(n&&(n.name||n.fullName))return[await(async()=>{const e=n;return{id:e.patient_id||e.id||(e.name||"").toLowerCase().replace(/\s+/g,"-"),name:e.name,dob:e.date_of_birth||e.dob,gender:e.gender,contact:e.phone_number,emergency:e.emergency_contact,insurance:e.insurance_type||e.insurance_provider,profile_picture:e.profile_picture||"",vitals:{heartRate:e.diagnosis_history?.[0]?.heart_rate?.value??null,temperature:e.diagnosis_history?.[0]?.temperature?.value??null,respiratoryRate:e.diagnosis_history?.[0]?.respiratory_rate?.value??null},diagnostics:(e.diagnostic_list||e.diagnostics||[]).map(e=>({problem:e.name||e.problem,description:e.description,status:e.status})),bpHistory:(e.diagnosis_history||[]).map(e=>({date:`${e.month||""}-${e.year||""}`,systolic:e.blood_pressure?.systolic?.value??null,diastolic:e.blood_pressure?.diastolic?.value??null})).reverse()}})()];return[mockPatient]}catch(t){return console.error("Error fetching all patients:",t),[mockPatient]}}function showDetails(){const e=[document.getElementById("contactBlock"),document.getElementById("emergencyBlock"),document.getElementById("insuranceBlock")].filter(Boolean);if(0===e.length)return;const t="none"===getComputedStyle(e[0]).display;e.forEach(e=>{e.style.display=t?"":"none"}),showAllBtn&&(showAllBtn.textContent=t?"Hide Information":"Show All Information")}async function init(){const e=await fetchAllPatients();renderPatientList(e);const t=e.find(e=>e.name==="Jessica Taylor")||e[0]||mockPatient;populateUI(t)}init();